{% extends "base.html" %}

{% block libs %}
    {% if config.extra.yandex %}
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function (m, e, t, r, i, k, a) {
            m[i] = m[i] || function () {
                (m[i].a = m[i].a || []).push(arguments)
            };
            var z = null;
            m[i].l = 1 * new Date();
            for (var j = 0; j < document.scripts.length; j++) {
                if (document.scripts[j].src === r) {
                    return;
                }
            }
            k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a)
        })
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

        ym({{ config.extra.yandex }}, "init", {
            clickmap: true,
            trackLinks: true,
            accurateTrackBounce: true
        });
    </script>
    <noscript>
        <div><img src="https://mc.yandex.ru/watch/{{ config.extra.yandex }}" style="position:absolute; left:-9999px;" alt=""/></div>
    </noscript>
    <!-- /Yandex.Metrika counter -->
    {% endif %}
{% endblock %}



{% block htmltitle %}
   {% set title = page.title %}

    {% set section = page %}
    {% if section.parent %}
        {% set section = section.parent %}
    {% endif %}
    {% if section.parent %}
        {% set section = section.parent %}
    {% endif %}
    {% if section.parent %}
        {% set section = section.parent %}
    {% endif %}
    {% set section = section.title %}

    {% if section and section != title %}
        {% set title = title ~ " / " ~ section %}
    {% endif %}
    {% set title = title ~ ' / ' ~ config.site_name %}


    <title>{{ title }}</title>
{% endblock %}

{% block extrahead %}
   {% set title = page.title %}

    {% set section = page %}
    {% if section.parent %}
        {% set section = section.parent %}
    {% endif %}
    {% if section.parent %}
        {% set section = section.parent %}
    {% endif %}
    {% if section.parent %}
        {% set section = section.parent %}
    {% endif %}
    {% set section = section.title %}

    {% if section %}
        {% set title = title ~ " / " ~ section %}
    {% endif %}
    {% set title = title ~ ' / ' ~ config.site_name %}

    {% if page and page.meta %}
        {% if page.meta.description %}
            {% set description = page.meta.description %}
        {% endif %}
        {% if page.meta.cover or page.meta.preview %}
            {% set cover =  config.site_url  ~  page.meta.cover or page.meta.preview %}
        {% endif %}
    {% endif %}
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="{{ title }}"/>
    <meta property="og:description" content="{{ description }}"/>
    <meta property="og:url" content="{{ page.canonical_url }}"/>
    <meta property="og:image" content="{{ cover }}"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="{{ title }}"/>
    <meta name="twitter:description" content="{{ description }}"/>
    <meta name="twitter:image" content="{{ cover }}"/>
{% endblock %}
